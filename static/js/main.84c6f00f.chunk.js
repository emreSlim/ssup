(this.webpackJsonpssup=this.webpackJsonpssup||[]).push([[0],{119:function(e,t,n){"use strict";n.r(t);var c=n(0),s=n(25),a=n.n(s),r=n(7),i=n(27);function o(e,t){var n="ssup-"+e,s=Object(c.useState)((function(){var e=localStorage.getItem(n);return null!=e?JSON.parse(e):"function"===typeof t?t():t})),a=Object(r.a)(s,2),i=a[0],o=a[1];return Object(c.useEffect)((function(){i&&localStorage.setItem(n,JSON.stringify(i))}),[i,n]),[i,o,function(){localStorage.removeItem(n)}]}var l=n(1),j=Object(c.createContext)();function d(){return Object(c.useContext)(j)}function u(e){var t=e.children,n=o("contacts",[]),c=Object(r.a)(n,2),s=c[0],a=c[1];return Object(l.jsx)(j.Provider,{value:{contacts:s,createContact:function(e,t){s.some((function(t){return t.id===e}))?alert("Oops! entry already exists."):a((function(n){return[].concat(Object(i.a)(n),[{id:e,name:t,isOnline:!1}])}))},removeContact:function(e){a((function(t){return t.filter((function(t,n){return e!==n}))}))},updateContacts:a},children:t})}var b=n(21),x=n(77),O=n.n(x),f=Object(c.createContext)();function m(){return Object(c.useContext)(f)}function h(e){var t=e.id,n=e.children,s=Object(c.useState)(),a=Object(r.a)(s,2),i=a[0],o=a[1],j=d().contacts,u=Object(c.useState)([]),b=Object(r.a)(u,2),x=b[0],m=b[1];return Object(c.useEffect)((function(){var e=O()("https://ssup-backend.herokuapp.com/",{query:{id:t}});return o(e),function(){return e.close()}}),[t]),Object(c.useEffect)((function(){if(null!=i)return i.on("online-users",m),function(){return i.off("online-users")}}),[j,i]),Object(l.jsx)(f.Provider,{value:{socket:i,onlineUsers:x},children:n})}var v=Object(c.createContext)();function p(){return Object(c.useContext)(v)}function g(e){var t=e.id,n=e.children,s=o("conversations",[]),a=Object(r.a)(s,2),j=a[0],u=a[1],x=m().socket,O=Object(c.useState)(0),f=Object(r.a)(O,2),h=f[0],p=f[1],g=d().contacts;var y=Object(c.useCallback)((function(e){var t=e.recipients,n=e.body,c=e.type,s=e.sender;u((function(e){var a=!1,r={sender:s,body:n,type:c},o=e.map((function(e){return n=e.recipients,c=t,n.length===c.length&&(n.sort(),c.sort(),n.every((function(e,t){return e===c[t]})))?(a=!0,Object(b.a)(Object(b.a)({},e),{},{messages:[].concat(Object(i.a)(e.messages),[r])})):e;var n,c}));return a?o:[].concat(Object(i.a)(e),[{recipients:t,messages:[r]}])}))}),[u]);Object(c.useEffect)((function(){if(null!=x)return x.on("receive-message",y),function(){x.off("receive-message")}}),[x,y]);var C=j.map((function(e,n){var c=e.recipients.map((function(e){var t=g.find((function(t){return t.id===e})),n=t&&t.name;return{id:e,name:n}})),s=e.messages.map((function(e){var n=g.find((function(t){return t.id===e.sender})),c=t===e.sender;return Object(b.a)(Object(b.a)({},e),{},{senderName:n&&n.name,senderID:e.sender,fromMe:c})})),a=n===h;return Object(b.a)(Object(b.a)({},e),{},{messages:s,recipients:c,selected:a})})),N={conversations:C,selectedConversation:C[h],createConversation:function(e){u((function(t){return[].concat(Object(i.a)(t),[{recipients:e,messages:[]}])}))},removeConversation:function(e){u((function(t){return t.filter((function(t,n){return e!==n}))}))},sendMessage:function(e){var n=e.recipients,c=e.body,s=e.type;x.emit("send-message",{recipients:n,body:c,type:s}),y({recipients:n,body:c,type:s,sender:t})},selectConversationIndex:p};return Object(l.jsx)(v.Provider,{value:N,children:n})}var y=n(122),C=n(132),N=n(123);function w(){var e=o("id")[2],t=Object(c.useState)(!1),n=Object(r.a)(t,2),s=n[0],a=n[1];function i(){a(!1)}return Object(l.jsxs)("div",{style:{position:"fixed",right:0},children:[Object(l.jsx)(y.a,{size:"sm",className:"d-flex align-items-center",onClick:function(){a(!0)},children:Object(l.jsx)(N.a,{className:"mr-2",size:30})}),Object(l.jsxs)(C.a,{show:s,onHide:i,children:[Object(l.jsx)(C.a.Header,{children:Object(l.jsx)("h5",{className:"m-0",children:"You will be logged out!"})}),Object(l.jsxs)(C.a.Body,{children:[Object(l.jsx)("p",{children:"Please save your ID before logging out or you may lose it."}),Object(l.jsxs)("div",{className:"d-flex justify-content-end",children:[Object(l.jsx)(y.a,{variant:"danger",className:"mx-2",onClick:function(){e(),i(),window.location.reload()},children:"Okay"}),Object(l.jsx)(y.a,{variant:"secondary",onClick:i,children:"Cancel"})]})]})]})]})}var k=n(59),S=n(60),I=n(133),M=n(124);function D(){var e=Object(c.useState)(""),t=Object(r.a)(e,2),n=t[0],s=t[1],a=Object(c.useState)(),i=Object(r.a)(a,2),o=i[0],j=i[1],d=p(),u=d.sendMessage,b=d.selectedConversation,x=Object(c.useRef)();return Object(l.jsx)(I.a,{onSubmit:function(e){if(e.preventDefault(),o){console.log(o);var t=new FileReader;t.readAsDataURL(o),t.addEventListener("loadend",(function(){u({recipients:b.recipients.map((function(e){return e.id})),body:t.result,type:o.type}),j()}))}else u({recipients:b.recipients.map((function(e){return e.id})),body:n,type:"text"});s("")},children:Object(l.jsx)(I.a.Group,{className:"m-1",children:Object(l.jsxs)(M.a,{className:"d-flex align-items-center",children:[Object(l.jsx)(M.a.Prepend,{children:Object(l.jsxs)("div",{className:"mx-2",children:[Object(l.jsx)(I.a.Control,{ref:x,onChange:function(e){var t=e.target.files[0];if(t.size>2e5)return alert("maximum image size should be 200 kB"),s(""),void j();s(t.name),j(t)},type:"file",className:"d-none",accept:".png, .jpg, .jpeg"}),Object(l.jsx)(k.a,{onClick:function(){x.current.click()},icon:S.a,size:"2x"})]})}),Object(l.jsx)(I.a.Control,{placeholder:"type your message here..",as:"textarea",required:!0,value:n,onChange:function(e){return s(e.target.value)},style:{height:"100px",resize:"none"}}),Object(l.jsx)(M.a.Append,{children:Object(l.jsxs)(y.a,{variant:"success",type:"submit",className:"d-flex flex-column align-items-center justify-content-center",children:[Object(l.jsx)(k.a,{icon:S.b,size:"2x"}),"Send"]})})]})})})}function z(){var e=Object(c.useCallback)((function(e){e&&e.scrollIntoView({smooth:!0})}),[]),t=p().selectedConversation;return Object(l.jsxs)("div",{className:"d-flex  flex-column flex-grow-1 border-left",children:[Object(l.jsx)("h5",{className:"text-white pl-2 bg-primary text-capitalize py-2 rounded",children:t.recipients.map((function(e){return e.name&&e.name||"Unknown"})).join(", ")}),Object(l.jsx)("div",{className:"flex-grow-1 overflow-auto",children:Object(l.jsx)("div",{className:"d-flex flex-column align-items-start justify-content-end px-3",children:t.messages.map((function(n,c){var s=t.messages.length-1===c;return"text"===n.type?Object(l.jsxs)("div",{ref:s?e:null,className:"d-flex flex-column ".concat(n.fromMe?"align-self-end align-items-end":"align-items-start"),children:[Object(l.jsx)("div",{className:"rounded px-2 py-1 font-weight-bold ".concat(n.fromMe?"bg-primary text-white":"bg-light border"),children:n.body}),Object(l.jsx)(a,{})]},c):Object(l.jsxs)("div",{className:"".concat(n.fromMe?"align-self-end":"align-self-start "),children:[Object(l.jsx)("div",{className:"".concat(n.fromMe?"bg-primary":"bg-light border"," p-1 rounded"),children:Object(l.jsx)("img",{style:{width:250,height:"auto"},src:n.body,alt:"sent by ".concat(n.senderName?n.senderName:n.fromMe?"you":"unknown contact")})}),Object(l.jsx)(a,{})]},c);function a(){return Object(l.jsx)("div",{className:"mb-2 text-muted small ".concat(n.senderName&&"text-capitalize"," px-1 ").concat(n.fromMe?"align-self-end":""),children:n.fromMe?"You":n.senderName&&n.senderName||n.senderID})}}))})}),Object(l.jsx)(D,{})]})}var P=n(136),F=n(134),L=n(129),H=n(130),B=n(137),E=n(125),R=n(126);function q(e){var t=e.dialogue,n=e.onPressDelete,c=e.closeModal;return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(C.a.Header,{closeButton:!0,children:Object(l.jsx)(C.a.Title,{children:"Confirm Delete?"})}),Object(l.jsx)(C.a.Body,{children:Object(l.jsx)("p",{children:t})}),Object(l.jsxs)(C.a.Footer,{children:[Object(l.jsx)(y.a,{variant:"danger",onClick:n,children:"Delete"}),Object(l.jsx)(y.a,{onClick:c,variant:"secondary",children:"Cancel"})]})]})}function A(){var e=d(),t=e.contacts,n=e.removeContact,s=Object(c.useState)(!1),a=Object(r.a)(s,2),i=a[0],o=a[1],j=Object(c.useState)(),u=Object(r.a)(j,2),b=u[0],x=u[1],O=Object(c.useState)(),f=Object(r.a)(O,2),m=f[0],h=f[1];function v(){o(!1)}return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(C.a,{show:i,onHide:v,children:Object(l.jsx)(q,{dialogue:'Contact entry "'.concat(b,'" will be removed!'),closeModal:function(){return o(!1)},onPressDelete:function(){n(m),v()}})}),Object(l.jsx)(B.a,{variant:"flush",children:t.map((function(e,t){return Object(l.jsxs)(B.a.Item,{children:[Object(l.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[Object(l.jsxs)("div",{className:"d-flex align-items-center col-md-11 p-0",children:[Object(l.jsx)(E.a,{}),Object(l.jsx)("p",{className:"m-0 p-0 ml-2 text-capitalize font-weight-bold col-md-10 text-break",children:e.name})]}),Object(l.jsx)(R.a,{className:"text-danger",onClick:function(){x(e.name),h(t),o(!0)}})]}),Object(l.jsx)("p",{className:"text-muted m-0 mt-1 font-weight-lighter text-center",style:{fontSize:14},children:e.id})]},e.id)}))})]})}var G=n(127);function K(){var e=Object(c.useState)(!1),t=Object(r.a)(e,2),n=t[0],s=t[1],a=Object(c.useState)(),i=Object(r.a)(a,2),o=i[0],j=i[1],d=Object(c.useState)(),u=Object(r.a)(d,2),b=u[0],x=u[1],O=p(),f=O.conversations,h=O.selectConversationIndex,v=O.removeConversation,g=m().onlineUsers;function y(){s(!1)}return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(C.a,{show:n,onHide:y,children:Object(l.jsx)(q,{dialogue:'Your conversation with "'.concat(o,'" will be deleted!'),closeModal:function(){return s(!1)},onPressDelete:function(){v(b),y(),h(0)}})}),Object(l.jsx)(B.a,{variant:"flush",children:f.map((function(e,t){var n="text-capitalize",c=e.recipients.map((function(e){var t="";return g.includes(e.id)&&(t=" (online)"),null!=e.name?e.name+t:(n="small",e.id+t)})).join(", ");return Object(l.jsxs)(B.a.Item,{className:"d-flex justify-content-between align-items-center "+n,action:!0,variant:"dark",onClick:function(){h(t)},active:e.selected,children:[Object(l.jsxs)("div",{className:"col-md-11 d-flex align-items-center p-0",children:[Object(l.jsx)(G.a,{className:"mr-2"}),Object(l.jsx)("div",{className:"col-md-10 p-0 text-break",children:c})]}),Object(l.jsx)(R.a,{className:"text-danger",onClick:function(){return function(e,t){j(t),x(e),s(!0)}(t,c)}})]},t)}))})]})}function Y(e){var t=e.closeModal,n=Object(c.useRef)(),s=Object(c.useRef)(),a=d().createContact;return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(C.a.Header,{children:"Create Contact"}),Object(l.jsx)(C.a.Body,{children:Object(l.jsxs)(I.a,{onSubmit:function(e){e.preventDefault();var c=n.current.value.trim();a(c,s.current.value),t()},children:[Object(l.jsxs)(I.a.Group,{children:[Object(l.jsx)(I.a.Label,{children:"Id"}),Object(l.jsx)(I.a.Control,{type:"text",ref:n,required:!0})]}),Object(l.jsxs)(I.a.Group,{children:[Object(l.jsx)(I.a.Label,{children:"Name"}),Object(l.jsx)(I.a.Control,{type:"text",ref:s,required:!0})]}),Object(l.jsx)(y.a,{type:"submit",children:"Create"})]})})]})}var J=n(128);function T(e){var t=e.heading,n=e.body,c=e.show,s=e.style;return c?Object(l.jsxs)(J.a,{className:"position-absolute w-100 text-center rounded",style:Object(b.a)({zIndex:99},s),variant:"danger",children:[Object(l.jsx)(J.a.Heading,{children:t}),Object(l.jsx)("p",{className:"m-0",children:n})]}):Object(l.jsx)("div",{})}function U(e){var t=e.closeModal,n=Object(c.useState)([]),s=Object(r.a)(n,2),a=s[0],o=s[1],j=d().contacts,u=p().createConversation,b=Object(c.useState)(!1),x=Object(r.a)(b,2),O=x[0],f=x[1];return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(T,{heading:"Oops!",body:"No contacts selected!",show:O}),Object(l.jsx)(C.a.Header,{children:Object(l.jsx)("h4",{children:"Create Conversation"})}),Object(l.jsx)(C.a.Body,{children:j.length<1?Object(l.jsx)("p",{className:"text-center text-danger font-weight-bold",children:'"Add contact before creating new conversation!"'}):Object(l.jsxs)(I.a,{onSubmit:function(e){e.preventDefault(),a.length?(u(a),t()):(f(!0),setTimeout((function(){return f(!1)}),500))},children:[j.map((function(e){return Object(l.jsx)(I.a.Group,{controlId:e.id,children:Object(l.jsx)(I.a.Check,{type:"checkbox",value:a.includes(e.id),label:e.name,onChange:function(){return t=e.id,void o((function(e){return e.includes(t)?e.filter((function(e){return t!==e})):[].concat(Object(i.a)(e),[t])}));var t}})},e.id)})),Object(l.jsx)(y.a,{type:"submit",children:"Create"})]})})]})}var V="conversations",W="contacts",Q="d-flex align-items-center justify-content-around m-0";function X(e){var t=e.id,n=Object(c.useState)(V),s=Object(r.a)(n,2),a=s[0],i=s[1],o=Object(c.useState)(!1),j=Object(r.a)(o,2),d=j[0],u=j[1];function b(){u(!1)}var x=a===V;return Object(l.jsxs)("div",{style:{maxWidth:"290px",width:"50vw"},className:"d-flex flex-column  border-right",children:[Object(l.jsxs)(P.a.Container,{activeKey:a,onSelect:i,children:[Object(l.jsxs)(F.a,{variant:"tabs",className:"justify-content-center",children:[Object(l.jsx)(F.a.Item,{children:Object(l.jsx)(F.a.Link,{eventKey:V,children:"Conversations"})}),Object(l.jsx)(F.a.Item,{children:Object(l.jsx)(F.a.Link,{eventKey:W,children:"Contacts"})})]}),Object(l.jsxs)(P.a.Content,{className:"overflow-auto flex-grow-1",children:[Object(l.jsx)(P.a.Pane,{eventKey:V,children:Object(l.jsx)(K,{})}),Object(l.jsx)(P.a.Pane,{eventKey:W,children:Object(l.jsx)(A,{})})]}),Object(l.jsxs)("div",{className:"p-2 border-top small",children:["Your ID : ",Object(l.jsx)("span",{className:"text-muted",children:t})]}),Object(l.jsx)(y.a,{variant:"dark",size:"sm",className:"m-2",onClick:function(){return u(!0)},children:x?Object(l.jsxs)("div",{className:Q,children:["New Conversation ",Object(l.jsx)(L.a,{})]}):Object(l.jsxs)("div",{className:Q,children:["Add New Contact ",Object(l.jsx)(H.a,{})]})})]}),Object(l.jsx)(C.a,{show:d,onHide:b,children:x?Object(l.jsx)(U,{closeModal:b}):Object(l.jsx)(Y,{closeModal:b})})]})}function Z(e){var t=e.id,n=p().selectedConversation;return Object(l.jsxs)("div",{className:"d-flex",style:{height:"100vh"},children:[Object(l.jsx)(X,{id:t}),n?Object(l.jsx)(z,{}):Object(l.jsx)($,{}),Object(l.jsx)(w,{})]})}function $(){return Object(l.jsx)("div",{className:"d-flex flex-grow-1 justify-content-center align-items-center",children:Object(l.jsx)("p",{className:"text-muted",children:"Conversations will display here!"})})}var _=n(131),ee=n(135);function te(e){var t=e.onIdSubmit,n=Object(c.useRef)();return Object(l.jsx)(_.a,{className:"align-items-center d-flex",style:{height:"100vh"},children:Object(l.jsxs)(I.a,{className:"w-100",onSubmit:function(e){e.preventDefault(),t(n.current.value)},children:[Object(l.jsxs)(I.a.Group,{children:[Object(l.jsx)(I.a.Label,{children:"Enter Your ID"}),Object(l.jsx)(I.a.Control,{type:"text",ref:n,required:!0})]}),Object(l.jsx)(y.a,{type:"submit",className:"mr-2",children:"Login"}),Object(l.jsx)(y.a,{variant:"secondary",onClick:function(){t(Object(ee.a)())},children:"Create A New Id"})]})})}var ne=function(){var e=o("id"),t=Object(r.a)(e,2),n=t[0],c=t[1];return n?Object(l.jsx)(u,{id:n,children:Object(l.jsx)(h,{id:n,children:Object(l.jsx)(g,{id:n,children:Object(l.jsx)(Z,{id:n})})})}):Object(l.jsx)(te,{onIdSubmit:c})},ce=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,138)).then((function(t){var n=t.getCLS,c=t.getFID,s=t.getFCP,a=t.getLCP,r=t.getTTFB;n(e),c(e),s(e),a(e),r(e)}))};n(118);a.a.render(Object(l.jsx)(ne,{}),document.getElementById("root")),ce()}},[[119,1,2]]]);
//# sourceMappingURL=main.84c6f00f.chunk.js.map