(this.webpackJsonpssup=this.webpackJsonpssup||[]).push([[0],{119:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n(25),s=n.n(a),r=n(7),i=n(27);function o(e,t){var n="ssup-"+e,a=Object(c.useState)((function(){var e=localStorage.getItem(n);return null!=e?JSON.parse(e):"function"===typeof t?t():t})),s=Object(r.a)(a,2),i=s[0],o=s[1];return Object(c.useEffect)((function(){i&&localStorage.setItem(n,JSON.stringify(i))}),[i,n]),[i,o,function(){localStorage.removeItem(n)}]}var l=n(1),j=Object(c.createContext)();function d(){return Object(c.useContext)(j)}function u(e){var t=e.children,n=o("contacts",[]),c=Object(r.a)(n,2),a=c[0],s=c[1];return Object(l.jsx)(j.Provider,{value:{contacts:a,createContact:function(e,t){a.some((function(t){return t.id===e}))?alert("Oops! entry already exists."):s((function(n){return[].concat(Object(i.a)(n),[{id:e,name:t,isOnline:!1}])}))},removeContact:function(e){s((function(t){return t.filter((function(t,n){return e!==n}))}))},updateContacts:s},children:t})}var b=n(21),O=n(77),x=n.n(O),f=Object(c.createContext)();function m(){return Object(c.useContext)(f)}function h(e){var t=e.id,n=e.children,a=Object(c.useState)(),s=Object(r.a)(a,2),i=s[0],o=s[1],j=d().contacts,u=Object(c.useState)([]),b=Object(r.a)(u,2),O=b[0],m=b[1];return Object(c.useEffect)((function(){var e=x()("https://ssup-backend.herokuapp.com/",{query:{id:t}});return o(e),function(){return e.close()}}),[t]),Object(c.useEffect)((function(){if(null!=i)return i.on("online-users",m),function(){return i.off("online-users")}}),[j,i]),Object(l.jsx)(f.Provider,{value:{socket:i,onlineUsers:O},children:n})}var v=Object(c.createContext)();function g(){return Object(c.useContext)(v)}function p(e){var t=e.id,n=e.children,a=o("conversations",[]),s=Object(r.a)(a,2),j=s[0],u=s[1],O=m().socket,x=Object(c.useState)(0),f=Object(r.a)(x,2),h=f[0],g=f[1],p=d().contacts;var y=Object(c.useCallback)((function(e){var t=e.recipients,n=e.body,c=e.type,a=e.sender;u((function(e){var s=!1,r={sender:a,body:n,type:c},o=e.map((function(e){return n=e.recipients,c=t,n.length===c.length&&(n.sort(),c.sort(),n.every((function(e,t){return e===c[t]})))?(s=!0,Object(b.a)(Object(b.a)({},e),{},{messages:[].concat(Object(i.a)(e.messages),[r])})):e;var n,c}));return s?o:[].concat(Object(i.a)(e),[{recipients:t,messages:[r]}])}))}),[u]);Object(c.useEffect)((function(){if(null!=O)return O.on("receive-message",y),function(){O.off("receive-message")}}),[O,y]);var C=j.map((function(e,n){var c=e.recipients.map((function(e){var t=p.find((function(t){return t.id===e})),n=t&&t.name;return{id:e,name:n}})),a=e.messages.map((function(e){var n=p.find((function(t){return t.id===e.sender})),c=t===e.sender;return Object(b.a)(Object(b.a)({},e),{},{senderName:n&&n.name,senderID:e.sender,fromMe:c})})),s=n===h;return Object(b.a)(Object(b.a)({},e),{},{messages:a,recipients:c,selected:s})})),N={conversations:C,selectedConversation:C[h],createConversation:function(e){u((function(t){return[].concat(Object(i.a)(t),[{recipients:e,messages:[]}])}))},removeConversation:function(e){u((function(t){return t.filter((function(t,n){return e!==n}))}))},sendMessage:function(e){var n=e.recipients,c=e.body,a=e.type;O.emit("send-message",{recipients:n,body:c,type:a}),y({recipients:n,body:c,type:a,sender:t})},selectConversationIndex:g};return Object(l.jsx)(v.Provider,{value:N,children:n})}var y=n(122),C=n(132),N=n(123);function w(){var e=o("id")[2],t=Object(c.useState)(!1),n=Object(r.a)(t,2),a=n[0],s=n[1];function i(){s(!1)}return Object(l.jsxs)("div",{style:{position:"fixed",right:0},children:[Object(l.jsx)(y.a,{size:"sm",className:"d-flex align-items-center",onClick:function(){s(!0)},children:Object(l.jsx)(N.a,{className:"mr-2",size:30})}),Object(l.jsxs)(C.a,{show:a,onHide:i,children:[Object(l.jsx)(C.a.Header,{children:Object(l.jsx)("h5",{className:"m-0",children:"You will be logged out!"})}),Object(l.jsxs)(C.a.Body,{children:[Object(l.jsx)("p",{children:"Please save your ID before logging out or you may lose it."}),Object(l.jsxs)("div",{className:"d-flex justify-content-end",children:[Object(l.jsx)(y.a,{variant:"danger",className:"mx-2",onClick:function(){e(),i(),window.location.reload()},children:"Okay"}),Object(l.jsx)(y.a,{variant:"secondary",onClick:i,children:"Cancel"})]})]})]})]})}var S=n(59),k=n(60),I=n(133),D=n(124);function M(){var e=Object(c.useState)(""),t=Object(r.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(),i=Object(r.a)(s,2),o=i[0],j=i[1],d=g(),u=d.sendMessage,b=d.selectedConversation,O=Object(c.useRef)();return Object(l.jsx)(I.a,{onSubmit:function(e){if(e.preventDefault(),o){console.log(o);var t=new FileReader;t.readAsDataURL(o),t.addEventListener("loadend",(function(){u({recipients:b.recipients.map((function(e){return e.id})),body:t.result,type:o.type}),j()}))}else u({recipients:b.recipients.map((function(e){return e.id})),body:n,type:"text"});a("")},children:Object(l.jsx)(I.a.Group,{className:"m-1",children:Object(l.jsxs)(D.a,{className:"d-flex align-items-center",children:[Object(l.jsx)(D.a.Prepend,{children:Object(l.jsxs)("div",{className:"mx-2",children:[Object(l.jsx)(I.a.Control,{ref:O,onChange:function(e){var t=e.target.files[0];if(null!=t){if(t.size&&t.size>2e5)return alert("maximum image size should be 200 kB"),a(""),void j();a(t.name),j(t)}},type:"file",className:"d-none",accept:".png, .jpg, .jpeg"}),Object(l.jsx)(S.a,{onClick:function(){O.current.click()},icon:k.a,size:"2x"})]})}),Object(l.jsx)(I.a.Control,{placeholder:"type your message here..",as:"textarea",required:!0,value:n,onChange:function(e){return a(e.target.value)},style:{height:"100px",resize:"none"}}),Object(l.jsx)(D.a.Append,{children:Object(l.jsxs)(y.a,{variant:"success",type:"submit",className:"d-flex flex-column align-items-center justify-content-center",children:[Object(l.jsx)(S.a,{icon:k.b,size:"2x"}),"Send"]})})]})})})}function z(){var e=Object(c.useCallback)((function(e){e&&e.scrollIntoView({smooth:!0})}),[]),t=g().selectedConversation;return Object(l.jsxs)("div",{className:"d-flex  flex-column flex-grow-1 border-left",children:[Object(l.jsx)("h5",{className:"text-white pl-2 bg-primary text-capitalize py-2 rounded",children:t.recipients.map((function(e){return e.name&&e.name||"Unknown"})).join(", ")}),Object(l.jsx)("div",{className:"flex-grow-1 overflow-auto",children:Object(l.jsx)("div",{className:"d-flex flex-column align-items-start justify-content-end px-3",children:t.messages.map((function(n,c){var a=t.messages.length-1===c;return"text"===n.type?Object(l.jsxs)("div",{ref:a?e:null,className:"d-flex flex-column ".concat(n.fromMe?"align-self-end align-items-end":"align-items-start"),children:[Object(l.jsx)("div",{className:"rounded px-2 py-1 font-weight-bold ".concat(n.fromMe?"bg-primary text-white":"bg-light"),children:n.body}),Object(l.jsx)(s,{})]},c):Object(l.jsxs)("div",{className:"".concat(n.fromMe?"align-self-end":"align-self-start "),children:[Object(l.jsx)("div",{className:"".concat(n.fromMe?"bg-primary":"bg-light"," p-1 rounded d-flex justify-content-center"),children:Object(l.jsx)("img",{style:{width:300,height:"auto"},src:n.body,alt:"sent by ".concat(n.senderName?n.senderName:n.fromMe?"you":"unknown contact")})}),Object(l.jsx)(s,{})]},c);function s(){return Object(l.jsx)("div",{className:"mb-2 small ".concat(n.senderName&&"text-capitalize"," px-1 ").concat(n.fromMe?"align-self-end":""),children:n.fromMe?"You":n.senderName&&n.senderName||n.senderID})}}))})}),Object(l.jsx)(M,{})]})}var P=n(136),F=n(134),L=n(129),H=n(130),B=n(137),E=n(125),R=n(126);function T(e){var t=e.dialogue,n=e.onPressDelete,c=e.closeModal;return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(C.a.Header,{closeButton:!0,children:Object(l.jsx)(C.a.Title,{children:"Confirm Delete?"})}),Object(l.jsx)(C.a.Body,{children:Object(l.jsx)("p",{children:t})}),Object(l.jsxs)(C.a.Footer,{children:[Object(l.jsx)(y.a,{variant:"danger",onClick:n,children:"Delete"}),Object(l.jsx)(y.a,{onClick:c,variant:"secondary",children:"Cancel"})]})]})}function q(){var e=d(),t=e.contacts,n=e.removeContact,a=Object(c.useState)(!1),s=Object(r.a)(a,2),i=s[0],o=s[1],j=Object(c.useState)(),u=Object(r.a)(j,2),b=u[0],O=u[1],x=Object(c.useState)(),f=Object(r.a)(x,2),m=f[0],h=f[1];function v(){o(!1)}return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(C.a,{show:i,onHide:v,children:Object(l.jsx)(T,{dialogue:'Contact entry "'.concat(b,'" will be removed!'),closeModal:function(){return o(!1)},onPressDelete:function(){n(m),v()}})}),Object(l.jsx)(B.a,{variant:"flush",children:t.map((function(e,t){return Object(l.jsxs)(B.a.Item,{variant:"primary",children:[Object(l.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[Object(l.jsxs)("div",{className:"d-flex align-items-center col-md-11 p-0",children:[Object(l.jsx)(E.a,{}),Object(l.jsx)("p",{className:"m-0 p-0 ml-2 text-capitalize font-weight-bold col-md-10 text-break",children:e.name})]}),Object(l.jsx)(R.a,{className:"text-danger",onClick:function(){O(e.name),h(t),o(!0)}})]}),Object(l.jsx)("p",{className:"text-muted m-0 mt-1 font-weight-lighter text-center",style:{fontSize:14},children:e.id})]},e.id)}))})]})}var A=n(127);function G(){var e=Object(c.useState)(!1),t=Object(r.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(),i=Object(r.a)(s,2),o=i[0],j=i[1],d=Object(c.useState)(),u=Object(r.a)(d,2),b=u[0],O=u[1],x=g(),f=x.conversations,h=x.selectConversationIndex,v=x.removeConversation,p=m().onlineUsers;function y(){a(!1)}return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(C.a,{show:n,onHide:y,children:Object(l.jsx)(T,{dialogue:'Your conversation with "'.concat(o,'" will be deleted!'),closeModal:function(){return a(!1)},onPressDelete:function(){v(b),y(),h(0)}})}),Object(l.jsx)(B.a,{variant:"flush",children:f.map((function(e,t){var n="text-capitalize",c=e.recipients.map((function(e){var t="";return p.includes(e.id)&&(t=" (online)"),null!=e.name?e.name+t:(n="small",e.id+t)})).join(", ");return Object(l.jsxs)(B.a.Item,{className:"d-flex justify-content-between align-items-center "+n,action:!0,variant:"dark",onClick:function(){h(t)},active:e.selected,children:[Object(l.jsxs)("div",{className:"col-md-11 d-flex align-items-center p-0",children:[Object(l.jsx)(A.a,{className:"mr-2"}),Object(l.jsx)("div",{className:"col-md-10 p-0 text-break",children:c})]}),Object(l.jsx)(R.a,{className:"text-danger",onClick:function(){return function(e,t){j(t),O(e),a(!0)}(t,c)}})]},t)}))})]})}function K(e){var t=e&&e.toString();if(t&&t.length>9){if(10===t.length&&!/\D/.test(t))return"number";if(t.length>10&&/\d/.test(t)&&/[a-z]/.test(t))return"id"}return!1}var Y=n(128);function J(e){var t=e.heading,n=e.body,c=e.show,a=e.style,s=e.focusOn;return c?(s&&s.current&&s.current.focus&&s.current.focus(),Object(l.jsxs)(Y.a,{className:"position-absolute w-100 text-center rounded",style:Object(b.a)({zIndex:99},a),variant:"danger",children:[Object(l.jsx)(Y.a.Heading,{children:t}),Object(l.jsx)("p",{className:"m-0",children:n})]})):Object(l.jsx)("div",{})}function U(e){var t=e.closeModal,n=Object(c.useRef)(),a=Object(c.useRef)(),s=d().createContact,i=Object(c.useState)(!1),o=Object(r.a)(i,2),j=o[0],u=o[1];return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(J,{focusOn:n,heading:"Invalid ID!",body:"Please input a valid ID to create a contact.",show:j}),Object(l.jsx)(C.a.Header,{children:"Create Contact"}),Object(l.jsx)(C.a.Body,{children:Object(l.jsxs)(I.a,{onSubmit:function(e){e.preventDefault();var c=n.current.value.trim();K(c)?(s(c,a.current.value),t()):(u(!0),setTimeout((function(){return u(!1)}),1e3))},children:[Object(l.jsxs)(I.a.Group,{children:[Object(l.jsx)(I.a.Label,{children:"Id"}),Object(l.jsx)(I.a.Control,{type:"text",ref:n,required:!0})]}),Object(l.jsxs)(I.a.Group,{children:[Object(l.jsx)(I.a.Label,{children:"Name"}),Object(l.jsx)(I.a.Control,{type:"text",ref:a,required:!0})]}),Object(l.jsx)(y.a,{type:"submit",children:"Create"})]})})]})}function V(e){var t=e.closeModal,n=Object(c.useState)([]),a=Object(r.a)(n,2),s=a[0],o=a[1],j=d().contacts,u=g().createConversation,b=Object(c.useState)(!1),O=Object(r.a)(b,2),x=O[0],f=O[1];return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(J,{heading:"Oops!",body:"No contacts selected!",show:x}),Object(l.jsx)(C.a.Header,{children:Object(l.jsx)("h4",{children:"Create Conversation"})}),Object(l.jsx)(C.a.Body,{children:j.length<1?Object(l.jsx)("p",{className:"text-center text-danger font-weight-bold",children:'"Add contact before creating new conversation!"'}):Object(l.jsxs)(I.a,{onSubmit:function(e){e.preventDefault(),s.length?(u(s),t()):(f(!0),setTimeout((function(){return f(!1)}),500))},children:[j.map((function(e){return Object(l.jsx)(I.a.Group,{controlId:e.id,children:Object(l.jsx)(I.a.Check,{type:"checkbox",value:s.includes(e.id),label:e.name,onChange:function(){return t=e.id,void o((function(e){return e.includes(t)?e.filter((function(e){return t!==e})):[].concat(Object(i.a)(e),[t])}));var t}})},e.id)})),Object(l.jsx)(y.a,{type:"submit",children:"Create"})]})})]})}var W="conversations",Q="contacts",X="d-flex align-items-center justify-content-around m-0";function Z(e){var t=e.id,n=Object(c.useState)(W),a=Object(r.a)(n,2),s=a[0],i=a[1],o=Object(c.useState)(!1),j=Object(r.a)(o,2),d=j[0],u=j[1];function b(){u(!1)}var O=s===W;return Object(l.jsxs)("div",{style:{maxWidth:"290px",width:"50vw",background:"linear-gradient(#fff 10%, #ddd)"},className:"d-flex flex-column  border-right",children:[Object(l.jsxs)(P.a.Container,{activeKey:s,onSelect:i,children:[Object(l.jsxs)(F.a,{variant:"tabs",className:"justify-content-center",children:[Object(l.jsx)(F.a.Item,{children:Object(l.jsx)(F.a.Link,{eventKey:W,children:"Conversations"})}),Object(l.jsx)(F.a.Item,{children:Object(l.jsx)(F.a.Link,{eventKey:Q,children:"Contacts"})})]}),Object(l.jsxs)(P.a.Content,{className:"overflow-auto flex-grow-1",children:[Object(l.jsx)(P.a.Pane,{eventKey:W,children:Object(l.jsx)(G,{})}),Object(l.jsx)(P.a.Pane,{eventKey:Q,children:Object(l.jsx)(q,{})})]}),Object(l.jsxs)("div",{className:"p-2 border-top small",children:["Your ID : ",Object(l.jsx)("span",{className:"text-muted",children:t})]}),Object(l.jsx)(y.a,{variant:"dark",size:"sm",className:"m-2",onClick:function(){return u(!0)},children:O?Object(l.jsxs)("div",{className:X,children:["New Conversation ",Object(l.jsx)(L.a,{})]}):Object(l.jsxs)("div",{className:X,children:["Add New Contact ",Object(l.jsx)(H.a,{})]})})]}),Object(l.jsx)(C.a,{show:d,onHide:b,children:O?Object(l.jsx)(V,{closeModal:b}):Object(l.jsx)(U,{closeModal:b})})]})}function $(e){var t=e.id,n=g().selectedConversation;return Object(l.jsxs)("div",{className:"d-flex",style:{height:"100vh"},children:[Object(l.jsx)(Z,{id:t}),Object(l.jsx)("div",{className:"d-flex flex-grow-1",style:{background:"linear-gradient(to right, #abc, #ddd)"},children:n?Object(l.jsx)(z,{}):Object(l.jsx)(_,{})}),Object(l.jsx)(w,{})]})}function _(){return Object(l.jsx)("div",{className:"d-flex flex-grow-1 justify-content-center align-items-center",children:Object(l.jsx)("p",{className:"text-muted",children:"Conversations will display here!"})})}var ee=n(131),te=n(135);function ne(e){var t=e.onIdSubmit,n=Object(c.useRef)(),a=Object(c.useState)(!1),s=Object(r.a)(a,2),i=s[0],o=s[1];return Object(l.jsxs)(l.Fragment,{children:[" ",Object(l.jsx)(J,{focusOn:n,heading:"Invalid ID!",body:"Please input a valid ID to login or create a new ID.",show:i}),Object(l.jsx)(ee.a,{className:"align-items-center d-flex",style:{height:"100vh"},children:Object(l.jsxs)(I.a,{className:"w-100",onSubmit:function(e){e.preventDefault();var c=n.current.value.trim();K(c)?t(c):(o(!0),setTimeout((function(){return o(!1)}),1e3))},children:[Object(l.jsxs)(I.a.Group,{children:[Object(l.jsx)(I.a.Label,{children:"Enter Your ID"}),Object(l.jsx)(I.a.Control,{type:"text",ref:n,required:!0})]}),Object(l.jsx)(y.a,{type:"submit",className:"mr-2",children:"Login"}),Object(l.jsx)(y.a,{variant:"secondary",onClick:function(){t(Object(te.a)())},children:"Create A New Id"})]})})]})}var ce=function(){var e=o("id"),t=Object(r.a)(e,2),n=t[0],c=t[1];return n?Object(l.jsx)(u,{id:n,children:Object(l.jsx)(h,{id:n,children:Object(l.jsx)(p,{id:n,children:Object(l.jsx)($,{id:n})})})}):Object(l.jsx)(ne,{onIdSubmit:c})},ae=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,138)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,s=t.getLCP,r=t.getTTFB;n(e),c(e),a(e),s(e),r(e)}))};n(118);s.a.render(Object(l.jsx)(ce,{}),document.getElementById("root")),ae()}},[[119,1,2]]]);
//# sourceMappingURL=main.ab240692.chunk.js.map